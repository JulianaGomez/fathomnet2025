{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "fbadab44",
   "metadata": {
    "papermill": {
     "duration": 0.006576,
     "end_time": "2025-03-19T21:34:55.622982",
     "exception": false,
     "start_time": "2025-03-19T21:34:55.616406",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Questions"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fefcdc66",
   "metadata": {
    "papermill": {
     "duration": 0.006209,
     "end_time": "2025-03-19T21:34:55.635448",
     "exception": false,
     "start_time": "2025-03-19T21:34:55.629239",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "1. How do we tackle differently-sized images?\n",
    "* If we clip them down, we lose the bounding boxes and target taxon.\n",
    "* If we standardize them by padding them, would we inadvertently train the model on the padding instead of the image?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "24cbef40",
   "metadata": {
    "papermill": {
     "duration": 0.005509,
     "end_time": "2025-03-19T21:34:55.646888",
     "exception": false,
     "start_time": "2025-03-19T21:34:55.641379",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Libraries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "6ca7e6d0",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2025-03-19T21:34:55.660378Z",
     "iopub.status.busy": "2025-03-19T21:34:55.659886Z",
     "iopub.status.idle": "2025-03-19T21:34:56.883363Z",
     "shell.execute_reply": "2025-03-19T21:34:56.881845Z"
    },
    "papermill": {
     "duration": 1.232686,
     "end_time": "2025-03-19T21:34:56.885434",
     "exception": false,
     "start_time": "2025-03-19T21:34:55.652748",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/fathomnet-2025/dataset_test.json\n",
      "/kaggle/input/fathomnet-2025/requirements.txt\n",
      "/kaggle/input/fathomnet-2025/download.py\n",
      "/kaggle/input/fathomnet-2025/dataset_train.json\n"
     ]
    }
   ],
   "source": [
    "import numpy as np \n",
    "import pandas as pd \n",
    "import os\n",
    "import json\n",
    "import re\n",
    "\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ebdd6773",
   "metadata": {
    "papermill": {
     "duration": 0.00513,
     "end_time": "2025-03-19T21:34:56.896511",
     "exception": false,
     "start_time": "2025-03-19T21:34:56.891381",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Import model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "f26c6e2c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:34:56.909100Z",
     "iopub.status.busy": "2025-03-19T21:34:56.908563Z",
     "iopub.status.idle": "2025-03-19T21:35:10.544605Z",
     "shell.execute_reply": "2025-03-19T21:35:10.543305Z"
    },
    "papermill": {
     "duration": 13.64476,
     "end_time": "2025-03-19T21:35:10.546625",
     "exception": false,
     "start_time": "2025-03-19T21:34:56.901865",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\r\n",
      "  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\r\n",
      "  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m44.8/44.8 kB\u001b[0m \u001b[31m1.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h  Building wheel for open_clip_torch (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\r\n"
     ]
    }
   ],
   "source": [
    "#taken from this starter notebook: https://www.kaggle.com/code/picekl/fungiclef25-starter-notebook\n",
    "!pip install -q git+https://github.com/mlfoundations/open_clip.git\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "dcc46d5f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:10.560529Z",
     "iopub.status.busy": "2025-03-19T21:35:10.560149Z",
     "iopub.status.idle": "2025-03-19T21:35:44.001848Z",
     "shell.execute_reply": "2025-03-19T21:35:44.000524Z"
    },
    "papermill": {
     "duration": 33.451704,
     "end_time": "2025-03-19T21:35:44.004396",
     "exception": false,
     "start_time": "2025-03-19T21:35:10.552692",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "9fc6b5a4821e42e699864822a71539a7",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "open_clip_pytorch_model.bin:   0%|          | 0.00/599M [00:00<?, ?B/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "18c242303b41454f9e6855f4520fec12",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "open_clip_config.json:   0%|          | 0.00/469 [00:00<?, ?B/s]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import open_clip\n",
    "\n",
    "model, preprocess_train, preprocess_val = open_clip.create_model_and_transforms('hf-hub:imageomics/bioclip')\n",
    "tokenizer = open_clip.get_tokenizer('hf-hub:imageomics/bioclip')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "12d6672e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:44.018270Z",
     "iopub.status.busy": "2025-03-19T21:35:44.017899Z",
     "iopub.status.idle": "2025-03-19T21:35:44.027180Z",
     "shell.execute_reply": "2025-03-19T21:35:44.026045Z"
    },
    "papermill": {
     "duration": 0.017922,
     "end_time": "2025-03-19T21:35:44.028821",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.010899",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "CLIP(\n",
       "  (visual): VisionTransformer(\n",
       "    (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)\n",
       "    (patch_dropout): Identity()\n",
       "    (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n",
       "    (transformer): Transformer(\n",
       "      (resblocks): ModuleList(\n",
       "        (0-11): 12 x ResidualAttentionBlock(\n",
       "          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n",
       "          (attn): MultiheadAttention(\n",
       "            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)\n",
       "          )\n",
       "          (ls_1): Identity()\n",
       "          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n",
       "          (mlp): Sequential(\n",
       "            (c_fc): Linear(in_features=768, out_features=3072, bias=True)\n",
       "            (gelu): GELU(approximate='none')\n",
       "            (c_proj): Linear(in_features=3072, out_features=768, bias=True)\n",
       "          )\n",
       "          (ls_2): Identity()\n",
       "        )\n",
       "      )\n",
       "    )\n",
       "    (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n",
       "  )\n",
       "  (transformer): Transformer(\n",
       "    (resblocks): ModuleList(\n",
       "      (0-11): 12 x ResidualAttentionBlock(\n",
       "        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)\n",
       "        (attn): MultiheadAttention(\n",
       "          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)\n",
       "        )\n",
       "        (ls_1): Identity()\n",
       "        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)\n",
       "        (mlp): Sequential(\n",
       "          (c_fc): Linear(in_features=512, out_features=2048, bias=True)\n",
       "          (gelu): GELU(approximate='none')\n",
       "          (c_proj): Linear(in_features=2048, out_features=512, bias=True)\n",
       "        )\n",
       "        (ls_2): Identity()\n",
       "      )\n",
       "    )\n",
       "  )\n",
       "  (token_embedding): Embedding(49408, 512)\n",
       "  (ln_final): LayerNorm((512,), eps=1e-05, elementwise_affine=True)\n",
       ")"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "c6cbe099",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:44.043412Z",
     "iopub.status.busy": "2025-03-19T21:35:44.043045Z",
     "iopub.status.idle": "2025-03-19T21:35:44.048632Z",
     "shell.execute_reply": "2025-03-19T21:35:44.047681Z"
    },
    "papermill": {
     "duration": 0.015012,
     "end_time": "2025-03-19T21:35:44.050299",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.035287",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<open_clip.tokenizer.SimpleTokenizer at 0x7bfe4963a890>"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tokenizer"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2853bde7",
   "metadata": {
    "papermill": {
     "duration": 0.006183,
     "end_time": "2025-03-19T21:35:44.063441",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.057258",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Explore train data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f5ed2b46",
   "metadata": {
    "papermill": {
     "duration": 0.007215,
     "end_time": "2025-03-19T21:35:44.077084",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.069869",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Load and inspect the JSON structure of the train set: \n",
    "\n",
    "1. Check whether it's a list or a dictionary\n",
    "2. If it's a list, check the number of items and the first item\n",
    "3. If it's a dictionary, check the keys and the values for the first key"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "9561e171",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:44.091992Z",
     "iopub.status.busy": "2025-03-19T21:35:44.091581Z",
     "iopub.status.idle": "2025-03-19T21:35:44.607534Z",
     "shell.execute_reply": "2025-03-19T21:35:44.606136Z"
    },
    "papermill": {
     "duration": 0.525753,
     "end_time": "2025-03-19T21:35:44.609576",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.083823",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'dict'>\n",
      "dict_keys(['info', 'images', 'licenses', 'annotations', 'categories'])\n",
      "{'year': 2025, 'version': '0', 'description': 'Generated by FathomNet', 'contributor': 'FathomNet', 'url': 'https://database.fathomnet.org', 'date_created': '2025/01/08'}\n"
     ]
    }
   ],
   "source": [
    "with open('/kaggle/input/fathomnet-2025/dataset_train.json', 'r') as f:\n",
    "    train_data = json.load(f)\n",
    "\n",
    "print(type(train_data))  \n",
    "if isinstance(train_data, list):\n",
    "    print(len(train_data))  \n",
    "    print(train_data[0])  \n",
    "elif isinstance(train_data, dict):\n",
    "    print(train_data.keys())  \n",
    "    print(train_data[list(train_data.keys())[0]])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7bb68570",
   "metadata": {
    "papermill": {
     "duration": 0.00657,
     "end_time": "2025-03-19T21:35:44.622712",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.616142",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Since it's a dictionary, create pandas dataframes for each of the keys and inspect them. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "08b3c284",
   "metadata": {
    "_kg_hide-input": true,
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:44.637162Z",
     "iopub.status.busy": "2025-03-19T21:35:44.636824Z",
     "iopub.status.idle": "2025-03-19T21:35:44.710421Z",
     "shell.execute_reply": "2025-03-19T21:35:44.708714Z"
    },
    "papermill": {
     "duration": 0.083298,
     "end_time": "2025-03-19T21:35:44.712468",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.629170",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "dict_keys(['images', 'licenses', 'annotations', 'categories'])\n"
     ]
    }
   ],
   "source": [
    "def load_data(key, data):\n",
    "    return pd.DataFrame(data[key])\n",
    "\n",
    "# create a dataframe with keys whose values are lists\n",
    "dataframes = {key: load_data(key, train_data) for key in train_data.keys() if isinstance(train_data[key], list)}\n",
    "print(dataframes.keys())\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0cb03f89",
   "metadata": {
    "papermill": {
     "duration": 0.006227,
     "end_time": "2025-03-19T21:35:44.725402",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.719175",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Information"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "6e3a3135",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:44.740829Z",
     "iopub.status.busy": "2025-03-19T21:35:44.740467Z",
     "iopub.status.idle": "2025-03-19T21:35:44.771803Z",
     "shell.execute_reply": "2025-03-19T21:35:44.770514Z"
    },
    "papermill": {
     "duration": 0.041761,
     "end_time": "2025-03-19T21:35:44.773771",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.732010",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>version</th>\n",
       "      <th>description</th>\n",
       "      <th>contributor</th>\n",
       "      <th>url</th>\n",
       "      <th>date_created</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2025</td>\n",
       "      <td>0</td>\n",
       "      <td>Generated by FathomNet</td>\n",
       "      <td>FathomNet</td>\n",
       "      <td>https://database.fathomnet.org</td>\n",
       "      <td>2025/01/08</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   year version             description contributor  \\\n",
       "0  2025       0  Generated by FathomNet   FathomNet   \n",
       "\n",
       "                              url date_created  \n",
       "0  https://database.fathomnet.org   2025/01/08  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dataframes['info'] = pd.DataFrame([train_data['info']])\n",
    "dataframes['info'].head()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "280b8c85",
   "metadata": {
    "papermill": {
     "duration": 0.008744,
     "end_time": "2025-03-19T21:35:44.789848",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.781104",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Images\n",
    "\n",
    "- Image dimensions differ: standardize? But bounding boxes might be lost, so maybe add padding to smaller ones. \n",
    "- some missing data for `date_captured`. Is this relevant to our analysis? Maybe it is, because of the granularity of the photo: check dates.  \n",
    "`file_name` follows same logic, so we could use regex to query them.\n",
    "- `license`: are all 0, can be discarded. \n",
    "- `flickr_url` and `coco_url`are identical, one can be dropped. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "4a95348b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:44.805358Z",
     "iopub.status.busy": "2025-03-19T21:35:44.804935Z",
     "iopub.status.idle": "2025-03-19T21:35:44.818801Z",
     "shell.execute_reply": "2025-03-19T21:35:44.817705Z"
    },
    "papermill": {
     "duration": 0.023887,
     "end_time": "2025-03-19T21:35:44.820719",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.796832",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are 8981 images in the train dataset\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>width</th>\n",
       "      <th>height</th>\n",
       "      <th>file_name</th>\n",
       "      <th>license</th>\n",
       "      <th>flickr_url</th>\n",
       "      <th>coco_url</th>\n",
       "      <th>date_captured</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>720</td>\n",
       "      <td>368</td>\n",
       "      <td>67cda248-6d28-4801-9c4e-e4525189ea38.png</td>\n",
       "      <td>0</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>2008-12-19 19:46:56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>1920</td>\n",
       "      <td>1080</td>\n",
       "      <td>d9b399f3-8628-4138-a339-f4520be751c5.png</td>\n",
       "      <td>0</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>2019-05-30 16:41:04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>1920</td>\n",
       "      <td>1080</td>\n",
       "      <td>3289c3e1-40f2-4512-992f-3fa406b50a86.png</td>\n",
       "      <td>0</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>2014-06-05 20:04:19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>1920</td>\n",
       "      <td>1080</td>\n",
       "      <td>801dc37d-1aac-49ac-9067-93ae4bb7c8b6.png</td>\n",
       "      <td>0</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>2017-12-21 15:37:28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>1920</td>\n",
       "      <td>1080</td>\n",
       "      <td>0026b62d-3ebc-4a70-b62e-5767a4e5f8b8.png</td>\n",
       "      <td>0</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>2021-08-14 16:25:58</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id  width  height                                 file_name  license  \\\n",
       "0   1    720     368  67cda248-6d28-4801-9c4e-e4525189ea38.png        0   \n",
       "1   2   1920    1080  d9b399f3-8628-4138-a339-f4520be751c5.png        0   \n",
       "2   3   1920    1080  3289c3e1-40f2-4512-992f-3fa406b50a86.png        0   \n",
       "3   4   1920    1080  801dc37d-1aac-49ac-9067-93ae4bb7c8b6.png        0   \n",
       "4   5   1920    1080  0026b62d-3ebc-4a70-b62e-5767a4e5f8b8.png        0   \n",
       "\n",
       "                                          flickr_url  \\\n",
       "0  https://database.fathomnet.org/static/m3/frame...   \n",
       "1  https://database.fathomnet.org/static/m3/frame...   \n",
       "2  https://database.fathomnet.org/static/m3/frame...   \n",
       "3  https://database.fathomnet.org/static/m3/frame...   \n",
       "4  https://database.fathomnet.org/static/m3/frame...   \n",
       "\n",
       "                                            coco_url        date_captured  \n",
       "0  https://database.fathomnet.org/static/m3/frame...  2008-12-19 19:46:56  \n",
       "1  https://database.fathomnet.org/static/m3/frame...  2019-05-30 16:41:04  \n",
       "2  https://database.fathomnet.org/static/m3/frame...  2014-06-05 20:04:19  \n",
       "3  https://database.fathomnet.org/static/m3/frame...  2017-12-21 15:37:28  \n",
       "4  https://database.fathomnet.org/static/m3/frame...  2021-08-14 16:25:58  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_images = len(dataframes['images'])\n",
    "print(f'There are {num_images} images in the train dataset')\n",
    "\n",
    "dataframes['images'].head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "e247c1d8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:44.835828Z",
     "iopub.status.busy": "2025-03-19T21:35:44.835486Z",
     "iopub.status.idle": "2025-03-19T21:35:44.859821Z",
     "shell.execute_reply": "2025-03-19T21:35:44.858518Z"
    },
    "papermill": {
     "duration": 0.033731,
     "end_time": "2025-03-19T21:35:44.861528",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.827797",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "All licenses are of type 0, 'license' column can be discarded.\n",
      "Columns flickr_url and coco_url are identical, one column can be discarded.\n",
      "All filenames follow the same pattern.\n",
      "Images range from 229 to 2048 in width and 237 to 1080 in height.\n"
     ]
    }
   ],
   "source": [
    "# Data quality check \n",
    "if dataframes['images']['license'].unique() == 0:\n",
    "    print(\"All licenses are of type 0, 'license' column can be discarded.\")\n",
    "\n",
    "if dataframes['images']['flickr_url'].equals(dataframes['images']['coco_url'])  :\n",
    "    print(\"Columns flickr_url and coco_url are identical, one column can be discarded.\")\n",
    "\n",
    "filename_pattern = re.compile(r'^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}\\.png$')\n",
    "def validate_filenames(filenames):\n",
    "    invalid_filenames = []\n",
    "    for filename in filenames:\n",
    "        if not filename_pattern.match(filename):\n",
    "            invalid_filenames.append(filename)\n",
    "    return invalid_filenames\n",
    "\n",
    "# Perform validation\n",
    "invalid_files = validate_filenames(dataframes['images']['file_name'])\n",
    "\n",
    "if invalid_files:\n",
    "    print(\"Invalid filenames detected:\")\n",
    "    print(invalid_files)\n",
    "else:\n",
    "    print(f\"All filenames follow the same pattern.\")\n",
    "\n",
    "\n",
    "min_width = dataframes['images']['width'].min()\n",
    "max_width = dataframes['images']['width'].max()\n",
    "min_height = dataframes['images']['height'].min()\n",
    "max_height = dataframes['images']['height'].max()\n",
    "\n",
    "\n",
    "print(f'Images range from {min_width} to {max_width} in width and {min_height} to {max_height} in height.')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "ab5fe502",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:44.877337Z",
     "iopub.status.busy": "2025-03-19T21:35:44.876922Z",
     "iopub.status.idle": "2025-03-19T21:35:45.260344Z",
     "shell.execute_reply": "2025-03-19T21:35:45.259100Z"
    },
    "papermill": {
     "duration": 0.393519,
     "end_time": "2025-03-19T21:35:45.262133",
     "exception": false,
     "start_time": "2025-03-19T21:35:44.868614",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<Axes: >"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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XnzxRRUUFOiRRx7RH/7wBw0bNky5ubk6duxYWw8NAAC0sXYbYB5//HHdf//9uueeezR48GCtWLFC8fHxeu6559p6aAAAoI21y8/A1NXVqaysTIWFhc6y6OhoZWdnq7S09Lzb+P1++f1+5/GJE39////48eMKBALhHbCkQCCg06dP66OPPpLL5br0jupiWm9Q4fTRR5Jase4mdD37Sav32Rq6Bo1Onw6qayBa54Khnw/46B/HpkXCMe+XMo4LqYtRIDrm7/NdFyNXMHj5fbb2GMMg3M/x9qq+7vM9x9u7S3oN/kNbzXdbn+sudE5ryuUc5ws5efKkJMkYc+GGph3661//aiSZ7du3hyyfNWuWueaaa867zSOPPGIk8cUXX3zxxRdfHeDrgw8+uGBWaJdXYC5FYWGhCgoKnMfBYFDHjx9Xr169FBUV/v891NTUKC0tTR988IE8Hk/Y99deUDd1d3SdsWaJuqm77RhjdPLkSaWmpl6wXbsMML1791aXLl1UVVUVsryqqkopKSnn3cbtdsvtdocsS0xMDNcQm+TxeNp88tsCdXcunbHuzlizRN2dTXupOyEh4aJt2uWHeGNiYjRq1Cht3LjRWRYMBrVx40Z5vd42HBkAAGgP2uUVGEkqKCjQlClTNHr0aF1zzTV64okn9Mknn+iee+5p66EBAIA21m4DzB133KG//e1vmjt3riorKzV8+HCtX79eycnJbT2083K73XrkkUcavY3V0VE3dXd0nbFmibqpu/2LMuZi9ykBAAC0L+3yMzAAAAAXQoABAADWIcAAAADrEGAAAIB1CDBNWLhwob74xS+qR48eSkpK0q233qpDhw6FtBk3bpyioqJCvh588MGQNhUVFcrLy1N8fLySkpI0a9YsnT17NpKltFhRUVGjugYOHOisr62tVX5+vnr16qXu3btr4sSJjX7poI11f/azn21Ud1RUlPLz8yV1nPneunWrvvrVryo1NVVRUVF69dVXQ9YbYzR37lz16dNHcXFxys7O1jvvvBPS5vjx45o8ebI8Ho8SExM1depUnTp1KqTNW2+9peuvv16xsbFKS0vT4sWLw11aky5UcyAQ0Jw5c5SZmalu3bopNTVVd999t44cORLSx/meH4sWLQpp055qli4+19/85jcb1XTzzTeHtLFtrqWL132+13lUVJQeffRRp42N892cn1utdf7evHmzRo4cKbfbrf79+6u4uDjc5TXWKn+8qAPKzc01q1atMvv37zfl5eXmy1/+sunXr585deqU0+ZLX/qSuf/++83Ro0edrxMnTjjrz549a4YMGWKys7PN3r17zbp160zv3r1NYWFhW5TUbI888oi5+uqrQ+r629/+5qx/8MEHTVpamtm4caPZs2ePGTNmjPmXf/kXZ72tdR87diykZp/PZySZN954wxjTceZ73bp15j//8z/Nr3/9ayPJvPLKKyHrFy1aZBISEsyrr75q/vjHP5qvfe1rJiMjw5w5c8Zpc/PNN5thw4aZHTt2mDfffNP079/f3Hnnnc76EydOmOTkZDN58mSzf/9+88tf/tLExcWZn/3sZ5EqM8SFaq6urjbZ2dnmxRdfNH/6059MaWmpueaaa8yoUaNC+khPTzfz588Pmf+G54P2VrMxF5/rKVOmmJtvvjmkpuPHj4e0sW2ujbl43Q3rPXr0qHnuuedMVFSUee+995w2Ns53c35utcb5+89//rOJj483BQUF5uDBg+anP/2p6dKli1m/fn1E6yXANNOxY8eMJLNlyxZn2Ze+9CXzne98p8lt1q1bZ6Kjo01lZaWzbPny5cbj8Ri/3x/O4V6WRx55xAwbNuy866qrq43L5TIvv/yys+ztt982kkxpaakxxt66P+073/mO+dznPmeCwaAxpmPO96dP7sFg0KSkpJhHH33UWVZdXW3cbrf55S9/aYwx5uDBg0aS2b17t9Pmd7/7nYmKijJ//etfjTHGPP300+aKK64IqXvOnDlmwIABYa7o4s73A+3Tdu3aZSSZv/zlL86y9PR0s2TJkia3ac81G3P+uqdMmWJuueWWJrexfa6Nad5833LLLebGG28MWWb7fBvT+OdWa52/Z8+eba6++uqQfd1xxx0mNzc33CWF4C2kZjpx4oQkqWfPniHLX3jhBfXu3VtDhgxRYWGhTp8+7awrLS1VZmZmyC/fy83NVU1NjQ4cOBCZgV+id955R6mpqbrqqqs0efJkVVRUSJLKysoUCASUnZ3ttB04cKD69eun0tJSSXbXXa+urk6/+MUvdO+994b8MdCOOt/1Dh8+rMrKypD5TUhIUFZWVsj8JiYmavTo0U6b7OxsRUdHa+fOnU6bsWPHKiYmxmmTm5urQ4cO6eOPP45QNZfuxIkTioqKavT31BYtWqRevXppxIgRevTRR0Muq9ta8+bNm5WUlKQBAwZo2rRp+uijj5x1nWGuq6qqtHbtWk2dOrXROtvn+9M/t1rr/F1aWhrSR32b+j4ipd3+Jt72JBgMasaMGbr22ms1ZMgQZ/nXv/51paenKzU1VW+99ZbmzJmjQ4cO6de//rUkqbKystFvDq5/XFlZGbkCWigrK0vFxcUaMGCAjh49qnnz5un666/X/v37VVlZqZiYmEYn9uTkZKcmW+tu6NVXX1V1dbW++c1vOss66nw3VD/O89XRcH6TkpJC1nft2lU9e/YMaZORkdGoj/p1V1xxRVjG3xpqa2s1Z84c3XnnnSF/1O6hhx7SyJEj1bNnT23fvl2FhYU6evSoHn/8cUl21nzzzTfr9ttvV0ZGht577z19//vf14QJE1RaWqouXbp0+LmWpOeff149evTQ7bffHrLc9vk+38+t1jp/N9WmpqZGZ86cUVxcXDhKaoQA0wz5+fnav3+/tm3bFrL8gQcecL7PzMxUnz59dNNNN+m9997T5z73uUgPs9VMmDDB+X7o0KHKyspSenq6XnrppYg9MdvaypUrNWHChJA/595R5xv/FAgE9O///u8yxmj58uUh6woKCpzvhw4dqpiYGP3Hf/yHFi5caNWvX29o0qRJzveZmZkaOnSoPve5z2nz5s266aab2nBkkfPcc89p8uTJio2NDVlu+3w39XOrI+EtpIuYPn261qxZozfeeEN9+/a9YNusrCxJ0rvvvitJSklJafTp7vrHKSkpYRhteCQmJuoLX/iC3n33XaWkpKiurk7V1dUhbaqqqpyabK/7L3/5i15//XXdd999F2zXEee7fpznq6Ph/B47dixk/dmzZ3X8+HGrnwP14eUvf/mLfD5fyNWX88nKytLZs2f1/vvvS7Kz5k+76qqr1Lt375DndEec63pvvvmmDh06dNHXumTXfDf1c6u1zt9NtfF4PBH9Ty4BpgnGGE2fPl2vvPKKNm3a1OhS4fmUl5dLkvr06SNJ8nq92rdvX8gJoP7EOHjw4LCMOxxOnTql9957T3369NGoUaPkcrm0ceNGZ/2hQ4dUUVEhr9cryf66V61apaSkJOXl5V2wXUec74yMDKWkpITMb01NjXbu3Bkyv9XV1SorK3PabNq0ScFg0Al1Xq9XW7duVSAQcNr4fD4NGDCgzS+tn099eHnnnXf0+uuvq1evXhfdpry8XNHR0c5bLLbVfD4ffvihPvroo5DndEeb64ZWrlypUaNGadiwYRdta8N8X+znVmudv71eb0gf9W3q+4iYiH5k2CLTpk0zCQkJZvPmzSG30Z0+fdoYY8y7775r5s+fb/bs2WMOHz5sfvOb35irrrrKjB071umj/na0nJwcU15ebtavX2+uvPLKdndb7ad997vfNZs3bzaHDx82v//97012drbp3bu3OXbsmDHm77fh9evXz2zatMns2bPHeL1e4/V6ne1trdsYY86dO2f69etn5syZE7K8I833yZMnzd69e83evXuNJPP444+bvXv3OnfcLFq0yCQmJprf/OY35q233jK33HLLeW+jHjFihNm5c6fZtm2b+fznPx9ya211dbVJTk42d911l9m/f7/51a9+ZeLj49vsFtML1VxXV2e+9rWvmb59+5ry8vKQ13v9XRfbt283S5YsMeXl5ea9994zv/jFL8yVV15p7r777nZbszEXrvvkyZPme9/7niktLTWHDx82r7/+uhk5cqT5/Oc/b2pra50+bJtrYy7+HDfm77dBx8fHm+XLlzfa3tb5vtjPLWNa5/xdfxv1rFmzzNtvv22WLVvGbdTtiaTzfq1atcoYY0xFRYUZO3as6dmzp3G73aZ///5m1qxZIb8XxBhj3n//fTNhwgQTFxdnevfubb773e+aQCDQBhU13x133GH69OljYmJizGc+8xlzxx13mHfffddZf+bMGfOtb33LXHHFFSY+Pt7cdttt5ujRoyF92Fi3McZs2LDBSDKHDh0KWd6R5vuNN94473N7ypQpxpi/30r9gx/8wCQnJxu3221uuummRsfjo48+Mnfeeafp3r278Xg85p577jEnT54MafPHP/7RXHfddcbtdpvPfOYzZtGiRZEqsZEL1Xz48OEmX+/1vwOorKzMZGVlmYSEBBMbG2sGDRpkfvSjH4X8oDemfdVszIXrPn36tMnJyTFXXnmlcblcJj093dx///0ht88aY99cG3Px57gxxvzsZz8zcXFxprq6utH2ts73xX5uGdN65+833njDDB8+3MTExJirrroqZB+REmWMMWG6uAMAABAWfAYGAABYhwADAACsQ4ABAADWIcAAAADrEGAAAIB1CDAAAMA6BBgAAGAdAgwAALAOAQYAAFiHAAMAAKxDgAEAANYhwAAAAOv8fxKwTLBTBymAAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#width and height\n",
    "dataframes['images']['width'].hist()\n",
    "dataframes['images']['height'].hist()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e1edbd94",
   "metadata": {
    "papermill": {
     "duration": 0.007375,
     "end_time": "2025-03-19T21:35:45.277407",
     "exception": false,
     "start_time": "2025-03-19T21:35:45.270032",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Licenses"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "b7ffdd43",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:45.294166Z",
     "iopub.status.busy": "2025-03-19T21:35:45.293774Z",
     "iopub.status.idle": "2025-03-19T21:35:45.303735Z",
     "shell.execute_reply": "2025-03-19T21:35:45.302644Z"
    },
    "papermill": {
     "duration": 0.020745,
     "end_time": "2025-03-19T21:35:45.305799",
     "exception": false,
     "start_time": "2025-03-19T21:35:45.285054",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>name</th>\n",
       "      <th>url</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>FathomNet</td>\n",
       "      <td>http://fathomnet.org/fathomnet/#/license</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id       name                                       url\n",
       "0   0  FathomNet  http://fathomnet.org/fathomnet/#/license"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dataframes['licenses'].head()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "60df9a5a",
   "metadata": {
    "papermill": {
     "duration": 0.007771,
     "end_time": "2025-03-19T21:35:45.322017",
     "exception": false,
     "start_time": "2025-03-19T21:35:45.314246",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Annotations\n",
    "\n",
    "- Bounding boxes\n",
    "- Some images have more than one bounding box (i.e. more than one taxon). "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "2545f6a1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:45.339653Z",
     "iopub.status.busy": "2025-03-19T21:35:45.339184Z",
     "iopub.status.idle": "2025-03-19T21:35:45.355170Z",
     "shell.execute_reply": "2025-03-19T21:35:45.354254Z"
    },
    "papermill": {
     "duration": 0.026486,
     "end_time": "2025-03-19T21:35:45.356857",
     "exception": false,
     "start_time": "2025-03-19T21:35:45.330371",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are 23699 annotations in the train dataset\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>image_id</th>\n",
       "      <th>category_id</th>\n",
       "      <th>segmentation</th>\n",
       "      <th>area</th>\n",
       "      <th>bbox</th>\n",
       "      <th>iscrowd</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>71</td>\n",
       "      <td>[]</td>\n",
       "      <td>943.0</td>\n",
       "      <td>[491.0, 254.0, 23.0, 41.0]</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>8</td>\n",
       "      <td>[]</td>\n",
       "      <td>71577.0</td>\n",
       "      <td>[701.0, 505.0, 241.0, 297.0]</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>67</td>\n",
       "      <td>[]</td>\n",
       "      <td>533148.0</td>\n",
       "      <td>[458.0, 332.0, 924.0, 577.0]</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>37</td>\n",
       "      <td>[]</td>\n",
       "      <td>299186.0</td>\n",
       "      <td>[1155.0, 71.0, 659.0, 454.0]</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>37</td>\n",
       "      <td>[]</td>\n",
       "      <td>520650.0</td>\n",
       "      <td>[66.0, 6.0, 975.0, 534.0]</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id  image_id  category_id segmentation      area  \\\n",
       "0   1         1           71           []     943.0   \n",
       "1   2         2            8           []   71577.0   \n",
       "2   3         3           67           []  533148.0   \n",
       "3   4         4           37           []  299186.0   \n",
       "4   5         4           37           []  520650.0   \n",
       "\n",
       "                           bbox  iscrowd  \n",
       "0    [491.0, 254.0, 23.0, 41.0]        0  \n",
       "1  [701.0, 505.0, 241.0, 297.0]        0  \n",
       "2  [458.0, 332.0, 924.0, 577.0]        0  \n",
       "3  [1155.0, 71.0, 659.0, 454.0]        0  \n",
       "4     [66.0, 6.0, 975.0, 534.0]        0  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_annot = len(dataframes['annotations'])\n",
    "print(f'There are {num_annot} annotations in the train dataset')\n",
    "dataframes['annotations'].head()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "96cbf129",
   "metadata": {
    "papermill": {
     "duration": 0.007556,
     "end_time": "2025-03-19T21:35:45.372697",
     "exception": false,
     "start_time": "2025-03-19T21:35:45.365141",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Categories\n",
    "\n",
    "- Competition description: \"The training set contains 79 categories of marine animals of varying taxonomic ranks (e.g., family, genus, species), wherein 300 example instances of each category are provided for training.\"\n",
    "\n",
    "**Our EDA**\n",
    "- Categories are taxa, ranging from class (i.e. *Gastropoda*) to order (i.e. *Zoantharia*) to species (i.e. *Abyssocucumis abyssorum*)\n",
    "- Training set has 79 categories - OK"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "ca1b5210",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:45.390787Z",
     "iopub.status.busy": "2025-03-19T21:35:45.390276Z",
     "iopub.status.idle": "2025-03-19T21:35:45.402991Z",
     "shell.execute_reply": "2025-03-19T21:35:45.401749Z"
    },
    "papermill": {
     "duration": 0.024411,
     "end_time": "2025-03-19T21:35:45.404782",
     "exception": false,
     "start_time": "2025-03-19T21:35:45.380371",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are 79 categories (taxa) in the train dataset\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>name</th>\n",
       "      <th>supercategory</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Abyssocucumis abyssorum</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Acanthascinae</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Acanthoptilum</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Actinernus</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Actiniaria</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id                     name supercategory\n",
       "0   1  Abyssocucumis abyssorum              \n",
       "1   2            Acanthascinae              \n",
       "2   3            Acanthoptilum              \n",
       "3   4               Actinernus              \n",
       "4   5               Actiniaria              "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_cat = len(dataframes['categories']['name'])\n",
    "print(f'There are {num_cat} categories (taxa) in the train dataset')\n",
    "\n",
    "dataframes['categories'].head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "69819cc8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:45.422336Z",
     "iopub.status.busy": "2025-03-19T21:35:45.421934Z",
     "iopub.status.idle": "2025-03-19T21:35:45.431567Z",
     "shell.execute_reply": "2025-03-19T21:35:45.430499Z"
    },
    "papermill": {
     "duration": 0.020179,
     "end_time": "2025-03-19T21:35:45.433191",
     "exception": false,
     "start_time": "2025-03-19T21:35:45.413012",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['Abyssocucumis abyssorum', 'Acanthascinae', 'Acanthoptilum',\n",
       "       'Actinernus', 'Actiniaria', 'Actinopterygii', 'Amphipoda',\n",
       "       'Apostichopus leukothele', 'Asbestopluma',\n",
       "       'Asbestopluma monticola', 'Asteroidea', 'Benthocodon pedunculata',\n",
       "       'Brisingida', 'Caridea', 'Ceriantharia', 'Chionoecetes tanneri',\n",
       "       'Chorilia longipes', 'Corallimorphus pilatus', 'Crinoidea',\n",
       "       'Delectopecten', 'Elpidia', 'Farrea', 'Florometra serratissima',\n",
       "       'Funiculina', 'Gastropoda', 'Gersemia juliepackardae',\n",
       "       'Heterocarpus', 'Heterochone calyx', 'Heteropolypus ritteri',\n",
       "       'Hexactinellida', 'Hippasteria', 'Holothuroidea', 'Hormathiidae',\n",
       "       'Isidella tentaculum', 'Isididae', 'Isosicyonis', 'Keratoisis',\n",
       "       'Liponema brevicorne', 'Lithodidae', 'Mediaster aequalis',\n",
       "       'Merluccius productus', 'Metridium farcimen',\n",
       "       'Microstomus pacificus', 'Munidopsis', 'Munnopsidae', 'Mycale',\n",
       "       'Octopus rubescens', 'Ophiacanthidae', 'Ophiuroidea',\n",
       "       'Paelopatides confundens', 'Pandalus amplus',\n",
       "       'Pandalus platyceros', 'Pannychia moseleyi', 'Paragorgia',\n",
       "       'Paragorgia arborea', 'Paralomis multispina', 'Parastenella',\n",
       "       'Peniagone', 'Pennatula phosphorea', 'Porifera',\n",
       "       'Psathyrometra fragilis', 'Psolus squamatus',\n",
       "       'Ptychogastria polaris', 'Pyrosoma atlanticum',\n",
       "       'Rathbunaster californicus', 'Scleractinia', 'Scotoplanes',\n",
       "       'Scotoplanes globosa', 'Sebastes', 'Sebastes diploproa',\n",
       "       'Sebastolobus', 'Serpulidae', 'Staurocalyptus',\n",
       "       'Strongylocentrotus fragilis', 'Terebellidae', 'Tunicata',\n",
       "       'Umbellula', 'Vesicomyidae', 'Zoantharia'], dtype=object)"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dataframes['categories']['name'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "be4bc9e1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:45.451568Z",
     "iopub.status.busy": "2025-03-19T21:35:45.451161Z",
     "iopub.status.idle": "2025-03-19T21:35:45.458300Z",
     "shell.execute_reply": "2025-03-19T21:35:45.457247Z"
    },
    "papermill": {
     "duration": 0.017748,
     "end_time": "2025-03-19T21:35:45.459820",
     "exception": false,
     "start_time": "2025-03-19T21:35:45.442072",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are no values in the supercategory series\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([''], dtype=object)"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(\"There are no values in the supercategory series\")\n",
    "dataframes['categories']['supercategory'].unique()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "52cfa1f3",
   "metadata": {
    "papermill": {
     "duration": 0.008264,
     "end_time": "2025-03-19T21:35:45.476598",
     "exception": false,
     "start_time": "2025-03-19T21:35:45.468334",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Join\n",
    "\n",
    "- Join images, annotations and categories, to check the number of images per category\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "9080135d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-03-19T21:35:45.497292Z",
     "iopub.status.busy": "2025-03-19T21:35:45.496879Z",
     "iopub.status.idle": "2025-03-19T21:35:45.548237Z",
     "shell.execute_reply": "2025-03-19T21:35:45.547093Z"
    },
    "papermill": {
     "duration": 0.065279,
     "end_time": "2025-03-19T21:35:45.550319",
     "exception": false,
     "start_time": "2025-03-19T21:35:45.485040",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>width</th>\n",
       "      <th>height</th>\n",
       "      <th>file_name</th>\n",
       "      <th>license</th>\n",
       "      <th>flickr_url</th>\n",
       "      <th>coco_url</th>\n",
       "      <th>date_captured</th>\n",
       "      <th>image_id</th>\n",
       "      <th>category_id</th>\n",
       "      <th>segmentation</th>\n",
       "      <th>area</th>\n",
       "      <th>bbox</th>\n",
       "      <th>iscrowd</th>\n",
       "      <th>name</th>\n",
       "      <th>supercategory</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>720.0</td>\n",
       "      <td>368.0</td>\n",
       "      <td>67cda248-6d28-4801-9c4e-e4525189ea38.png</td>\n",
       "      <td>0.0</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>2008-12-19 19:46:56</td>\n",
       "      <td>1</td>\n",
       "      <td>71</td>\n",
       "      <td>[]</td>\n",
       "      <td>943.0</td>\n",
       "      <td>[491.0, 254.0, 23.0, 41.0]</td>\n",
       "      <td>0</td>\n",
       "      <td>Abyssocucumis abyssorum</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>1920.0</td>\n",
       "      <td>1080.0</td>\n",
       "      <td>d9b399f3-8628-4138-a339-f4520be751c5.png</td>\n",
       "      <td>0.0</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>2019-05-30 16:41:04</td>\n",
       "      <td>2</td>\n",
       "      <td>8</td>\n",
       "      <td>[]</td>\n",
       "      <td>71577.0</td>\n",
       "      <td>[701.0, 505.0, 241.0, 297.0]</td>\n",
       "      <td>0</td>\n",
       "      <td>Acanthascinae</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>1920.0</td>\n",
       "      <td>1080.0</td>\n",
       "      <td>3289c3e1-40f2-4512-992f-3fa406b50a86.png</td>\n",
       "      <td>0.0</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>2014-06-05 20:04:19</td>\n",
       "      <td>3</td>\n",
       "      <td>67</td>\n",
       "      <td>[]</td>\n",
       "      <td>533148.0</td>\n",
       "      <td>[458.0, 332.0, 924.0, 577.0]</td>\n",
       "      <td>0</td>\n",
       "      <td>Acanthoptilum</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>1920.0</td>\n",
       "      <td>1080.0</td>\n",
       "      <td>801dc37d-1aac-49ac-9067-93ae4bb7c8b6.png</td>\n",
       "      <td>0.0</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>2017-12-21 15:37:28</td>\n",
       "      <td>4</td>\n",
       "      <td>37</td>\n",
       "      <td>[]</td>\n",
       "      <td>299186.0</td>\n",
       "      <td>[1155.0, 71.0, 659.0, 454.0]</td>\n",
       "      <td>0</td>\n",
       "      <td>Actinernus</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>1920.0</td>\n",
       "      <td>1080.0</td>\n",
       "      <td>0026b62d-3ebc-4a70-b62e-5767a4e5f8b8.png</td>\n",
       "      <td>0.0</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>https://database.fathomnet.org/static/m3/frame...</td>\n",
       "      <td>2021-08-14 16:25:58</td>\n",
       "      <td>4</td>\n",
       "      <td>37</td>\n",
       "      <td>[]</td>\n",
       "      <td>520650.0</td>\n",
       "      <td>[66.0, 6.0, 975.0, 534.0]</td>\n",
       "      <td>0</td>\n",
       "      <td>Actiniaria</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id   width  height                                 file_name  license  \\\n",
       "0   1   720.0   368.0  67cda248-6d28-4801-9c4e-e4525189ea38.png      0.0   \n",
       "1   2  1920.0  1080.0  d9b399f3-8628-4138-a339-f4520be751c5.png      0.0   \n",
       "2   3  1920.0  1080.0  3289c3e1-40f2-4512-992f-3fa406b50a86.png      0.0   \n",
       "3   4  1920.0  1080.0  801dc37d-1aac-49ac-9067-93ae4bb7c8b6.png      0.0   \n",
       "4   5  1920.0  1080.0  0026b62d-3ebc-4a70-b62e-5767a4e5f8b8.png      0.0   \n",
       "\n",
       "                                          flickr_url  \\\n",
       "0  https://database.fathomnet.org/static/m3/frame...   \n",
       "1  https://database.fathomnet.org/static/m3/frame...   \n",
       "2  https://database.fathomnet.org/static/m3/frame...   \n",
       "3  https://database.fathomnet.org/static/m3/frame...   \n",
       "4  https://database.fathomnet.org/static/m3/frame...   \n",
       "\n",
       "                                            coco_url        date_captured  \\\n",
       "0  https://database.fathomnet.org/static/m3/frame...  2008-12-19 19:46:56   \n",
       "1  https://database.fathomnet.org/static/m3/frame...  2019-05-30 16:41:04   \n",
       "2  https://database.fathomnet.org/static/m3/frame...  2014-06-05 20:04:19   \n",
       "3  https://database.fathomnet.org/static/m3/frame...  2017-12-21 15:37:28   \n",
       "4  https://database.fathomnet.org/static/m3/frame...  2021-08-14 16:25:58   \n",
       "\n",
       "   image_id  category_id segmentation      area                          bbox  \\\n",
       "0         1           71           []     943.0    [491.0, 254.0, 23.0, 41.0]   \n",
       "1         2            8           []   71577.0  [701.0, 505.0, 241.0, 297.0]   \n",
       "2         3           67           []  533148.0  [458.0, 332.0, 924.0, 577.0]   \n",
       "3         4           37           []  299186.0  [1155.0, 71.0, 659.0, 454.0]   \n",
       "4         4           37           []  520650.0     [66.0, 6.0, 975.0, 534.0]   \n",
       "\n",
       "   iscrowd                     name supercategory  \n",
       "0        0  Abyssocucumis abyssorum                \n",
       "1        0            Acanthascinae                \n",
       "2        0            Acanthoptilum                \n",
       "3        0               Actinernus                \n",
       "4        0               Actiniaria                "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "result = pd.merge(pd.merge(dataframes['images'], dataframes['annotations'], on='id', how='outer'), dataframes['categories'], on='id', how='outer')\n",
    "result.head()"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "databundleVersionId": 11305476,
     "sourceId": 88612,
     "sourceType": "competition"
    }
   ],
   "dockerImageVersionId": 30918,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 56.628629,
   "end_time": "2025-03-19T21:35:49.157735",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-03-19T21:34:52.529106",
   "version": "2.6.0"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {
     "06f0e238a774464b9e0af8c44bfce1f6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_62f6495cdbda46ef9a9d38dbf58cd5ca",
       "placeholder": "​",
       "style": "IPY_MODEL_f756f499795c4edd84464ad9c0eae5ff",
       "tabbable": null,
       "tooltip": null,
       "value": "open_clip_pytorch_model.bin: 100%"
      }
     },
     "16e6b372ecd141d2bbd1732c6eed6206": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_baa8f8706636465797e3e705997f6985",
       "placeholder": "​",
       "style": "IPY_MODEL_3ad138dd047f4b9ba1621c2eb124d9bd",
       "tabbable": null,
       "tooltip": null,
       "value": "open_clip_config.json: 100%"
      }
     },
     "18c242303b41454f9e6855f4520fec12": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_16e6b372ecd141d2bbd1732c6eed6206",
        "IPY_MODEL_b5c8658778f44ded8701ecce756766e7",
        "IPY_MODEL_861306b0e20b455fa457ad79c264d5d2"
       ],
       "layout": "IPY_MODEL_d57c7f134ff54350bba04c05a16ac209",
       "tabbable": null,
       "tooltip": null
      }
     },
     "3ad138dd047f4b9ba1621c2eb124d9bd": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "44b17a1af2464314a8d37815823186d1": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "5e72731e0e3b4d7ab7851ffb69c1a2d0": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_86d163854387438a881f0afc7d35f79e",
       "placeholder": "​",
       "style": "IPY_MODEL_d2c1fca9ba7d4c34906097b33a23d76d",
       "tabbable": null,
       "tooltip": null,
       "value": " 599M/599M [00:02&lt;00:00, 241MB/s]"
      }
     },
     "62f6495cdbda46ef9a9d38dbf58cd5ca": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "861306b0e20b455fa457ad79c264d5d2": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_d01487cfdb5c49398efde86ac051a095",
       "placeholder": "​",
       "style": "IPY_MODEL_90565cf9789444529372170fe8442118",
       "tabbable": null,
       "tooltip": null,
       "value": " 469/469 [00:00&lt;00:00, 36.8kB/s]"
      }
     },
     "86d163854387438a881f0afc7d35f79e": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "8abbb39b9219454c89735e9e8f91f436": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "90565cf9789444529372170fe8442118": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "9fc6b5a4821e42e699864822a71539a7": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_06f0e238a774464b9e0af8c44bfce1f6",
        "IPY_MODEL_c389e222ffd54918bb672c8a3df190a7",
        "IPY_MODEL_5e72731e0e3b4d7ab7851ffb69c1a2d0"
       ],
       "layout": "IPY_MODEL_a626a134d1684adbb359ba8a4e1ae8fe",
       "tabbable": null,
       "tooltip": null
      }
     },
     "a626a134d1684adbb359ba8a4e1ae8fe": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "b5c8658778f44ded8701ecce756766e7": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_8abbb39b9219454c89735e9e8f91f436",
       "max": 469.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_f3c34e3cb3224e6286fc2cf82b9fe828",
       "tabbable": null,
       "tooltip": null,
       "value": 469.0
      }
     },
     "baa8f8706636465797e3e705997f6985": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "c389e222ffd54918bb672c8a3df190a7": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "2.0.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_allow_html": false,
       "layout": "IPY_MODEL_c8648e0b9d304bbaa5d1234d2c674bed",
       "max": 598599013.0,
       "min": 0.0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_44b17a1af2464314a8d37815823186d1",
       "tabbable": null,
       "tooltip": null,
       "value": 598599013.0
      }
     },
     "c8648e0b9d304bbaa5d1234d2c674bed": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "d01487cfdb5c49398efde86ac051a095": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "d2c1fca9ba7d4c34906097b33a23d76d": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     },
     "d57c7f134ff54350bba04c05a16ac209": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "f3c34e3cb3224e6286fc2cf82b9fe828": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "f756f499795c4edd84464ad9c0eae5ff": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "2.0.0",
      "model_name": "HTMLStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "2.0.0",
       "_model_name": "HTMLStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "StyleView",
       "background": null,
       "description_width": "",
       "font_size": null,
       "text_color": null
      }
     }
    },
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
